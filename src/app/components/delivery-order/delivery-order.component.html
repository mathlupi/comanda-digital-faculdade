<div class="container mx-auto p-4">
  <!-- Abas -->
  <div class="flex border-b mb-4">
    <button
      class="px-4 py-2"
      [ngClass]="activeTab === 'ready' ? 'tab-active' : 'tab-inactive'"
      (click)="setActiveTab('ready')"
    >
      Prontos para retirada
    </button>
    <button
      class="px-4 py-2"
      [ngClass]="activeTab === 'inTransit' ? 'tab-active' : 'tab-inactive'"
      (click)="setActiveTab('inTransit')"
    >
      A caminho
    </button>
    <button
      class="px-4 py-2"
      [ngClass]="activeTab === 'delivered' ? 'tab-active' : 'tab-inactive'"
      (click)="setActiveTab('delivered')"
    >
      Entregues
    </button>
  </div>

  <!-- Prontos para retirada -->
  <div *ngIf="activeTab === 'ready'">
    <h2 class="text-2xl font-bold mb-4 text-maroon-700">
      Pedidos prontos para retirada
    </h2>
    <div *ngIf="readyOrders.length === 0" class="text-gray-500">
      Nenhum pedido pronto.
    </div>

    <div
      *ngFor="let order of readyOrders; trackBy: trackByOrder"
      class="border p-4 mb-2 rounded shadow bg-white"
    >
      <div class="flex items-start justify-between">
        <div>
          <p class="font-semibold">Pedido ID: {{ order.id }}</p>
          <p>Cliente: {{ order.customerName }}</p>
          <p>Endereço: {{ order.customerAddress }}</p>
          <p>Total: R$ {{ order.totalPrice.toFixed(2) }}</p>
          <p class="text-sm text-gray-600">
            Total de itens: {{ order.totalItems }}
          </p>
        </div>
        <button
          class="btn-maroon h-10"
          (click)="setStatus(order.id!, 'Motoboy a caminho')"
        >
          Retirar pedido
        </button>
      </div>

      <!-- ITENS DO PEDIDO -->
      <div class="mt-3">
        <p class="font-semibold mb-1">Itens:</p>
        <ul class="list-disc ml-5 space-y-1">
          <li *ngFor="let it of order.items; trackBy: trackByItem">
            <div class="flex flex-col">
              <span>
                <strong>{{ it.quantity }}×</strong> {{ it.dish.name }}
                <span
                  *ngIf="it.customized"
                  class="ml-1 text-xs px-2 py-0.5 rounded bg-yellow-100 text-yellow-800 align-middle"
                >
                  personalizado
                </span>
              </span>
              <small class="text-gray-600" *ngIf="it.ingredients?.length">
                Ingredientes: {{ it.ingredients.join(", ") }}
              </small>
            </div>
          </li>
        </ul>
      </div>
    </div>
  </div>

  <!-- A caminho -->
  <div *ngIf="activeTab === 'inTransit'">
    <h2 class="text-2xl font-bold mb-4 text-maroon-700">Pedidos a caminho</h2>
    <div *ngIf="inTransitOrders.length === 0" class="text-gray-500">
      Nenhum pedido a caminho.
    </div>

    <div
      *ngFor="let order of inTransitOrders; trackBy: trackByOrder"
      class="border p-4 mb-2 rounded shadow bg-white"
    >
      <div class="flex items-start justify-between">
        <div>
          <p class="font-semibold">Pedido ID: {{ order.id }}</p>
          <p>Cliente: {{ order.customerName }}</p>
          <p>Endereço: {{ order.customerAddress }}</p>
          <p>Total: R$ {{ order.totalPrice.toFixed(2) }}</p>
          <p class="text-sm text-gray-600">
            Total de itens: {{ order.totalItems }}
          </p>
        </div>
        <button
          class="btn-maroon h-10"
          (click)="setStatus(order.id!, 'Entregue')"
        >
          Marcar como entregue
        </button>
      </div>

      <!-- ITENS DO PEDIDO -->
      <div class="mt-3">
        <p class="font-semibold mb-1">Itens que o motoboy está levando:</p>
        <ul class="list-disc ml-5 space-y-1">
          <li *ngFor="let it of order.items; trackBy: trackByItem">
            <div class="flex flex-col">
              <span>
                <strong>{{ it.quantity }}×</strong> {{ it.dish.name }}
                <span
                  *ngIf="it.customized"
                  class="ml-1 text-xs px-2 py-0.5 rounded bg-yellow-100 text-yellow-800 align-middle"
                >
                  personalizado
                </span>
              </span>
              <small class="text-gray-600" *ngIf="it.ingredients?.length">
                Ingredientes: {{ it.ingredients.join(", ") }}
              </small>
            </div>
          </li>
        </ul>
      </div>
    </div>
  </div>

  <!-- Entregues -->
  <div *ngIf="activeTab === 'delivered'">
    <h2 class="text-2xl font-bold mb-4 text-maroon-700">Pedidos entregues</h2>
    <div *ngIf="deliveredOrders.length === 0" class="text-gray-500">
      Nenhum pedido entregue.
    </div>

    <div
      *ngFor="let order of deliveredOrders; trackBy: trackByOrder"
      class="border p-4 mb-2 rounded shadow bg-white"
    >
      <p class="font-semibold">Pedido ID: {{ order.id }}</p>
      <p>Cliente: {{ order.customerName }}</p>
      <p>Endereço: {{ order.customerAddress }}</p>
      <p>Total: R$ {{ order.totalPrice.toFixed(2) }}</p>
      <p class="text-sm text-gray-600">
        Total de itens: {{ order.totalItems }}
      </p>

      <!-- ITENS DO PEDIDO -->
      <div class="mt-3">
        <p class="font-semibold mb-1">Itens entregues:</p>
        <ul class="list-disc ml-5 space-y-1">
          <li *ngFor="let it of order.items; trackBy: trackByItem">
            <div class="flex flex-col">
              <span>
                <strong>{{ it.quantity }}×</strong> {{ it.dish.name }}
                <span
                  *ngIf="it.customized"
                  class="ml-1 text-xs px-2 py-0.5 rounded bg-yellow-100 text-yellow-800 align-middle"
                >
                  personalizado
                </span>
              </span>
              <small class="text-gray-600" *ngIf="it.ingredients?.length">
                Ingredientes: {{ it.ingredients.join(", ") }}
              </small>
            </div>
          </li>
        </ul>
      </div>
    </div>

    <p class="font-bold mt-4">Ganhos totais: R$ {{ earnings.toFixed(2) }}</p>
  </div>
</div>
